<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Opex QA Test Analytics</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="bg"></div>
    <div class="app">
      <header class="topbar">
        <div class="title-block">
          <h1>Opex QA Test Analytics</h1>
          <p>For Opex QA Team</p>
          <div class="meta">
            <span id="last-updated">Last updated: --</span>
            <span id="status-chip" class="chip status">STATUS</span>
          </div>
        </div>
        <div class="actions">
          <button id="refresh-btn" class="btn ghost">Refresh</button>
          <button id="download-btn" class="btn glow">Download JSON</button>
          <span id="mode-chip" class="chip mode">INTERACTIVE</span>
        </div>
      </header>

      <section id="error-card" class="card error hidden">
        <h2>Report Load Failed</h2>
        <p>We could not load the Mochawesome report.</p>
        <div class="error-meta">
          <div>
            <strong>Attempted URLs</strong>
            <ul id="error-list"></ul>
          </div>
          <div class="hint">
            Quick fix: Upload your report <code> </code> or ensure
            <code>mochawesome.json</code> exists the dir.
          </div>
        </div>
      </section>

      <main class="grid">
        <section class="left">
          <div class="card chart-card">
            <div class="card-header">
              <h2>Distribution</h2>
              <div class="legend">
                <span class="legend-item pass"><i></i>Pass</span>
                <span class="legend-item fail"><i></i>Fail</span>
                <span class="legend-item skipped"><i></i>Skipped</span>
                <span class="legend-item pending"><i></i>Pending</span>
              </div>
            </div>
            <div class="chart-wrap">
              <svg id="donut" viewBox="0 0 260 260" aria-label="Test result donut chart">
                <defs>
                  <filter id="glow">
                    <feGaussianBlur stdDeviation="4" result="blur" />
                    <feMerge>
                      <feMergeNode in="blur" />
                      <feMergeNode in="SourceGraphic" />
                    </feMerge>
                  </filter>
                </defs>
                <circle class="donut-track" cx="130" cy="130" r="88"></circle>
                <g id="donut-group" transform="rotate(-90 130 130)"></g>
              </svg>
              <div class="chart-center">
                <div id="center-label" class="center-label">Total Tests</div>
                <div id="total-tests" class="center-value">0</div>
                <div id="center-sub" class="center-sub">Tap a segment to filter</div>
              </div>
            </div>
            <div class="runtime-pill">
              <div class="pill-label">Runtime</div>
              <div class="pill-bar">
                <div id="runtime-fill" class="pill-fill"></div>
              </div>
              <div id="runtime-text" class="pill-text">0.0m</div>
            </div>
          </div>

          <div class="metrics-grid">
            <div class="card metric">
              <div class="metric-label">Tests</div>
              <div id="metric-tests" class="metric-value">0</div>
            </div>
            <div class="card metric pass">
              <div class="metric-label">Pass</div>
              <div id="metric-pass" class="metric-value">0</div>
            </div>
            <div class="card metric fail">
              <div class="metric-label">Fail</div>
              <div id="metric-fail" class="metric-value">0</div>
            </div>
            <div class="card metric skipped">
              <div class="metric-label">Skipped</div>
              <div id="metric-skipped" class="metric-value">0</div>
            </div>
            <div class="card metric">
              <div class="metric-label">Pass Rate</div>
              <div id="metric-passrate" class="metric-value">0.0%</div>
            </div>
            <div class="card metric runtime">
              <div class="metric-label">Runtime</div>
              <div id="metric-runtime" class="metric-value">0.0m</div>
            </div>
          </div>

          <div class="card suite-card">
            <div class="card-header">
              <h2>Suites</h2>
              <span class="sparkline">
                <i></i><i></i><i></i><i></i><i></i><i></i>
              </span>
            </div>
            <div id="suite-list" class="suite-list">No suites detected yet.</div>
          </div>
        </section>

        <section class="right">
          <div class="card table-card">
            <div class="table-controls">
              <div class="filters">
                <button class="pill active" data-filter="all">All</button>
                <button class="pill pass" data-filter="passed">Passed</button>
                <button class="pill fail" data-filter="failed">Failed</button>
                <button class="pill skipped" data-filter="skipped">Skipped</button>
                <button class="pill pending" data-filter="pending">Pending</button>
              </div>
              <div class="search">
                <input id="search-input" type="search" placeholder="Search tests or tags..." />
              </div>
              <div class="source-control">
                <label for="source-input">Report source</label>
                <div class="source-input">
                  <input id="source-input" type="text" placeholder="../cypress/reports/mochawesome.json" />
                  <button id="load-btn" class="btn ghost">Load</button>
                </div>
                <div class="source-upload">
                  <input id="file-input" type="file" accept=".json,application/json" />
                  <label class="upload-label" for="file-input">Upload Mochawesome JSON</label>
                  <span id="file-name" class="file-name">No file selected</span>
                </div>
              </div>
            </div>

            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>Status</th>
                    <th>Title</th>
                    <th>Tags</th>
                    <th>Duration</th>
                  </tr>
                </thead>
                <tbody id="tests-body"></tbody>
              </table>
            </div>
          </div>
        </section>
      </main>
    </div>

    <div id="tooltip" class="tooltip hidden"></div>
    <script src="app.js"></script>
  </body>
</html>
